<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic REDCapR Operations • REDCapR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Basic REDCapR Operations">
<meta property="og:description" content="REDCapR">
<meta property="og:image" content="https://ouhscbbmc.github.io/REDCapR/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">REDCapR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/OuhscBbmc/REDCapR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="BasicREDCapROperations_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic REDCapR Operations</h1>
            
            <h4 data-toc-skip class="date">2022-08-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/OuhscBbmc/REDCapR/blob/HEAD/vignettes/BasicREDCapROperations.Rmd" class="external-link"><code>vignettes/BasicREDCapROperations.Rmd</code></a></small>
      <div class="hidden name"><code>BasicREDCapROperations.Rmd</code></div>

    </div>

    
    
<p>This vignette covers the the basic functions exposed by the <a href="https://github.com/r-lib/httr" class="external-link"><code>httr</code></a> and <a href="https://cran.r-project.org/package=curl" class="external-link"><code>curl</code></a> packages which allow you to interact with <a href="https://www.project-redcap.org/" class="external-link">REDCap</a> through its API.</p>
<div class="section level2">
<h2 id="reading-redcap-data">Reading REDCap Data<a class="anchor" aria-label="anchor" href="#reading-redcap-data"></a>
</h2>
<p>The function <code>redcap_read_oneshot</code> uses the <a href="https://cran.r-project.org/package=httr" class="external-link"><code>httr</code></a> package to call the REDCap API.</p>
<pre><code><span><span class="co">## Loading required namespace: kableExtra</span></span></code></pre>
<div class="section level3">
<h3 id="set-project-wide-values">Set project-wide values<a class="anchor" aria-label="anchor" href="#set-project-wide-values"></a>
</h3>
<p>There is some information that is specific to the REDCap project, as opposed to an individual operation. This includes the (1) uri of the server, and the (2) token for the user’s project.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ouhscbbmc.github.io/REDCapR/">REDCapR</a></span><span class="op">)</span> <span class="co"># Load the package into the current R session.</span></span>
<span><span class="va">uri</span>   <span class="op">&lt;-</span> <span class="st">"https://bbmc.ouhsc.edu/redcap/api/"</span></span>
<span><span class="va">token</span> <span class="op">&lt;-</span> <span class="st">"9A81268476645C4E5F03428B8AC3AA7B"</span> <span class="co"># `UnitTestPhiFree` user and simple project (pid 153)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="read-all-records-and-fields">Read all records and fields<a class="anchor" aria-label="anchor" href="#read-all-records-and-fields"></a>
</h3>
<p>If no information is passed about the desired records or fields, then the entire data set is returned. Only two parameters are required, <code>redcap_uri</code> and <code>token</code>. Unless the <code>verbose</code> parameter is set to <code>FALSE</code>, a message will be printed on the R console with the number of records and fields returned.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Return all records and all variables.</span></span>
<span><span class="va">ds_all_rows_all_fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redcap_read.html">redcap_read</a></span><span class="op">(</span>redcap_uri <span class="op">=</span> <span class="va">uri</span>, token <span class="op">=</span> <span class="va">token</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></code></pre></div>
<pre><code>The data dictionary describing 17 fields was read from REDCap in 0.5 seconds.  The http status code was 200.</code></pre>
<pre><code>5 records and 1 columns were read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>Starting to read 5 records  at 2022-08-14 21:12:14.</code></pre>
<pre><code>Reading batch 1 of 1, with subjects 1 through 5 (ie, 5 unique subject records).</code></pre>
<pre><code>5 records and 25 columns were read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>
 [36m── [39m  [1mColumn specification [22m  [36m──────────────────────────────────────────────────────── [39m
cols(
  .default = col_double(),
  name_first =  [31mcol_character() [39m,
  name_last =  [31mcol_character() [39m,
  address =  [31mcol_character() [39m,
  telephone =  [31mcol_character() [39m,
  email =  [31mcol_character() [39m,
  dob =  [34mcol_date(format = "") [39m,
  comments =  [31mcol_character() [39m,
  mugshot =  [31mcol_character() [39m
)
 [36mℹ [39m Use `spec()` for the full column specifications.</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_all_rows_all_fields</span> <span class="co"># Inspect the returned dataset</span></span></code></pre></div>
<pre><code>  record_id name_first name_last                                 address
1         1     Nutmeg  Nutmouse 14 Rose Cottage St.\nKenning UK, 323232
2         2     Tumtum  Nutmouse 14 Rose Cottage Blvd.\nKenning UK 34243
3         3     Marcus      Wood          243 Hill St.\nGuthrie OK 73402
4         4      Trudy       DAG          342 Elm\nDuncanville TX, 75116
5         5   John Lee    Walker      Hotel Suite\nNew Orleans LA, 70115
       telephone               email        dob age sex demographics_complete
1 (405) 321-1111     nutty@mouse.com 2003-08-30  11   0                     2
2 (405) 321-2222    tummy@mouse.comm 2003-03-10  11   1                     2
3 (405) 321-3333        mw@mwood.net 1934-04-09  80   1                     2
4 (405) 321-4444 peroxide@blonde.com 1952-11-02  61   0                     2
5 (405) 321-5555  left@hippocket.com 1955-04-15  59   1                     2
  height weight   bmi
1   7.00      1 204.1
2   6.00      1 277.8
3 180.00     80  24.7
4 165.00     54  19.8
5 193.04    104  27.9
                                                                                                     comments
1                                                                     Character in a book, with some guessing
2                                                                          A mouse character from a good book
3                                                                                          completely made up
4 This record doesn't have a DAG assigned\n\nSo call up Trudy on the telephone\nSend her a letter in the mail
5                 Had a hand for trouble and a eye for cash\n\nHe had a gold watch chain and a black mustache
        mugshot health_complete race___1 race___2 race___3 race___4 race___5
1 mugshot-1.jpg               1        0        0        0        0        1
2 mugshot-2.jpg               0        0        0        1        0        1
3 mugshot-3.jpg               2        0        0        0        1        1
4 mugshot-4.jpg               2        0        1        0        0        1
5 mugshot-5.jpg               0        1        0        0        0        0
  race___6 ethnicity interpreter_needed race_and_ethnicity_complete
1        0         1                  0                           2
2        0         1                  0                           0
3        0         0                  1                           2
4        0         1                 NA                           2
5        1         2                  0                           2</code></pre>
</div>
<div class="section level3">
<h3 id="read-a-subset-of-the-records">Read a subset of the records<a class="anchor" aria-label="anchor" href="#read-a-subset-of-the-records"></a>
</h3>
<p>If only a subset of the <strong>records</strong> is desired, the two approaches are shown below. The first is to pass an array (where each element is an ID) to the <code>records</code> parameter. The second is to pass a single string (where the elements are separated by commas) to the <code>records_collapsed</code> parameter.</p>
<p>The first format is more natural for more R users. The second format is what is expected by the REDCap API. If a value for <code>records</code> is specified, but <code>records_collapsed</code> is not specified, then <code>redcap_read_oneshot</code> automatically converts the array into the format needed by the API.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Return only records with IDs of 1 and 3</span></span>
<span><span class="va">desired_records_v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">ds_some_rows_v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redcap_read.html">redcap_read</a></span><span class="op">(</span></span>
<span>  redcap_uri <span class="op">=</span> <span class="va">uri</span>,</span>
<span>  token      <span class="op">=</span> <span class="va">token</span>,</span>
<span>  records    <span class="op">=</span> <span class="va">desired_records_v1</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></code></pre></div>
<pre><code>The data dictionary describing 17 fields was read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>2 records and 1 columns were read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>Starting to read 2 records  at 2022-08-14 21:12:15.</code></pre>
<pre><code>Reading batch 1 of 1, with subjects 1 through 3 (ie, 2 unique subject records).</code></pre>
<pre><code>2 records and 25 columns were read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>
 [36m── [39m  [1mColumn specification [22m  [36m──────────────────────────────────────────────────────── [39m
cols(
  .default = col_double(),
  name_first =  [31mcol_character() [39m,
  name_last =  [31mcol_character() [39m,
  address =  [31mcol_character() [39m,
  telephone =  [31mcol_character() [39m,
  email =  [31mcol_character() [39m,
  dob =  [34mcol_date(format = "") [39m,
  comments =  [31mcol_character() [39m,
  mugshot =  [31mcol_character() [39m
)
 [36mℹ [39m Use `spec()` for the full column specifications.</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Return only records with IDs of 1 and 3 (alternate way)</span></span>
<span><span class="va">desired_records_v2</span> <span class="op">&lt;-</span> <span class="st">"1, 3"</span></span>
<span><span class="va">ds_some_rows_v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redcap_read.html">redcap_read</a></span><span class="op">(</span></span>
<span>  redcap_uri        <span class="op">=</span> <span class="va">uri</span>,</span>
<span>  token             <span class="op">=</span> <span class="va">token</span>,</span>
<span>  records_collapsed <span class="op">=</span> <span class="va">desired_records_v2</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></code></pre></div>
<pre><code>The data dictionary describing 17 fields was read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>2 records and 1 columns were read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>Starting to read 2 records  at 2022-08-14 21:12:16.</code></pre>
<pre><code>Reading batch 1 of 1, with subjects 1 through 3 (ie, 2 unique subject records).</code></pre>
<pre><code>2 records and 25 columns were read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>
 [36m── [39m  [1mColumn specification [22m  [36m──────────────────────────────────────────────────────── [39m
cols(
  .default = col_double(),
  name_first =  [31mcol_character() [39m,
  name_last =  [31mcol_character() [39m,
  address =  [31mcol_character() [39m,
  telephone =  [31mcol_character() [39m,
  email =  [31mcol_character() [39m,
  dob =  [34mcol_date(format = "") [39m,
  comments =  [31mcol_character() [39m,
  mugshot =  [31mcol_character() [39m
)
 [36mℹ [39m Use `spec()` for the full column specifications.</code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_some_rows_v2</span> <span class="co"># Inspect the returned dataset</span></span></code></pre></div>
<pre><code>  record_id name_first name_last                                 address
1         1     Nutmeg  Nutmouse 14 Rose Cottage St.\nKenning UK, 323232
2         3     Marcus      Wood          243 Hill St.\nGuthrie OK 73402
       telephone           email        dob age sex demographics_complete
1 (405) 321-1111 nutty@mouse.com 2003-08-30  11   0                     2
2 (405) 321-3333    mw@mwood.net 1934-04-09  80   1                     2
  height weight   bmi                                comments       mugshot
1      7      1 204.1 Character in a book, with some guessing mugshot-1.jpg
2    180     80  24.7                      completely made up mugshot-3.jpg
  health_complete race___1 race___2 race___3 race___4 race___5 race___6
1               1        0        0        0        0        1        0
2               2        0        0        0        1        1        0
  ethnicity interpreter_needed race_and_ethnicity_complete
1         1                  0                           2
2         0                  1                           2</code></pre>
</div>
<div class="section level3">
<h3 id="read-a-subset-of-the-fields">Read a subset of the fields<a class="anchor" aria-label="anchor" href="#read-a-subset-of-the-fields"></a>
</h3>
<p>If only a subset of the <strong>fields</strong> is desired, then two approaches exist. The first is to pass an array (where each element is an field) to the <code>fields</code> parameter. The second is to pass a single string (where the elements are separated by commas) to the <code>fields_collapsed</code> parameter. Like with <code>records</code> and <code>records_collapsed</code> described above, this function converts the more natural format (<em>i.e.</em>, <code>fields</code>) to the format required by the API (<em>ie</em>, <code>fields_collapsed</code>) if <code>fields</code> is specified and <code>fields_collapsed</code> is not.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Return only the fields record_id, name_first, and age</span></span>
<span><span class="va">desired_fields_v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"record_id"</span>, <span class="st">"name_first"</span>, <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="va">ds_some_fields_v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redcap_read.html">redcap_read</a></span><span class="op">(</span></span>
<span>  redcap_uri <span class="op">=</span> <span class="va">uri</span>,</span>
<span>  token      <span class="op">=</span> <span class="va">token</span>,</span>
<span>  fields     <span class="op">=</span> <span class="va">desired_fields_v1</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></code></pre></div>
<pre><code>The data dictionary describing 17 fields was read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>5 records and 1 columns were read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>Starting to read 5 records  at 2022-08-14 21:12:18.</code></pre>
<pre><code>Reading batch 1 of 1, with subjects 1 through 5 (ie, 5 unique subject records).</code></pre>
<pre><code>5 records and 3 columns were read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>
 [36m── [39m  [1mColumn specification [22m  [36m──────────────────────────────────────────────────────── [39m
cols(
  record_id =  [32mcol_double() [39m,
  name_first =  [31mcol_character() [39m,
  age =  [32mcol_double() [39m
)</code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Return only the fields record_id, name_first, and age (alternate way)</span></span>
<span><span class="va">desired_fields_v2</span> <span class="op">&lt;-</span> <span class="st">"record_id, name_first, age"</span></span>
<span><span class="va">ds_some_fields_v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redcap_read.html">redcap_read</a></span><span class="op">(</span></span>
<span>  redcap_uri       <span class="op">=</span> <span class="va">uri</span>,</span>
<span>  token            <span class="op">=</span> <span class="va">token</span>,</span>
<span>  fields_collapsed <span class="op">=</span> <span class="va">desired_fields_v2</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></code></pre></div>
<pre><code>The data dictionary describing 17 fields was read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>5 records and 1 columns were read from REDCap in 0.4 seconds.  The http status code was 200.</code></pre>
<pre><code>Starting to read 5 records  at 2022-08-14 21:12:19.</code></pre>
<pre><code>Reading batch 1 of 1, with subjects 1 through 5 (ie, 5 unique subject records).</code></pre>
<pre><code>5 records and 3 columns were read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>
 [36m── [39m  [1mColumn specification [22m  [36m──────────────────────────────────────────────────────── [39m
cols(
  record_id =  [32mcol_double() [39m,
  name_first =  [31mcol_character() [39m,
  age =  [32mcol_double() [39m
)</code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_some_fields_v2</span> <span class="co">#Inspect the returned dataset</span></span></code></pre></div>
<pre><code>  record_id name_first age
1         1     Nutmeg  11
2         2     Tumtum  11
3         3     Marcus  80
4         4      Trudy  61
5         5   John Lee  59</code></pre>
</div>
<div class="section level3">
<h3 id="read-a-subset-of-records-conditioned-on-the-values-in-some-variables">Read a subset of records, conditioned on the values in some variables<a class="anchor" aria-label="anchor" href="#read-a-subset-of-records-conditioned-on-the-values-in-some-variables"></a>
</h3>
<p>The two techniques above can be combined when your datasets are large and you don’t want to pull records with certain values. Suppose you want to select subjects from the previous dataset <em>if</em> the were born before 1960 and their weight was over 70kg. Two calls to the server are required. The <strong>first call</strong> to REDCap pulls all the records, but for only three columns: <code>record_id</code>, <code>dob</code>, and <code>weight</code>. From this subset, identify the records that you want to pull all the data for; in this case, the desired <code>record_id</code> values are <code>3</code> &amp; <code>5</code>. The <strong>second call</strong> to REDCap pulls all the columns, but only for the identified records.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">######</span></span>
<span><span class="co">## Step 1: First call to REDCap</span></span>
<span><span class="va">desired_fields_v3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"record_id"</span>, <span class="st">"dob"</span>, <span class="st">"weight"</span><span class="op">)</span></span>
<span><span class="va">ds_some_fields_v3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redcap_read.html">redcap_read</a></span><span class="op">(</span></span>
<span>  redcap_uri <span class="op">=</span> <span class="va">uri</span>,</span>
<span>  token      <span class="op">=</span> <span class="va">token</span>,</span>
<span>  fields     <span class="op">=</span> <span class="va">desired_fields_v3</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></code></pre></div>
<pre><code>The data dictionary describing 17 fields was read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>5 records and 1 columns were read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>Starting to read 5 records  at 2022-08-14 21:12:20.</code></pre>
<pre><code>Reading batch 1 of 1, with subjects 1 through 5 (ie, 5 unique subject records).</code></pre>
<pre><code>5 records and 3 columns were read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>
 [36m── [39m  [1mColumn specification [22m  [36m──────────────────────────────────────────────────────── [39m
cols(
  record_id =  [32mcol_double() [39m,
  dob =  [34mcol_date(format = "") [39m,
  weight =  [32mcol_double() [39m
)</code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_some_fields_v3</span> <span class="co">#Examine the these three variables.</span></span></code></pre></div>
<pre><code>  record_id        dob weight
1         1 2003-08-30      1
2         2 2003-03-10      1
3         3 1934-04-09     80
4         4 1952-11-02     54
5         5 1955-04-15    104</code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">######</span></span>
<span><span class="co">## Step 2: identify desired records, based on age &amp; weight</span></span>
<span><span class="va">before_1960</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ds_some_fields_v3</span><span class="op">$</span><span class="va">dob</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1960-01-01"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">heavier_than_70_kg</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ds_some_fields_v3</span><span class="op">$</span><span class="va">weight</span> <span class="op">&gt;</span> <span class="fl">70</span><span class="op">)</span></span>
<span><span class="va">desired_records_v3</span> <span class="op">&lt;-</span> <span class="va">ds_some_fields_v3</span><span class="op">[</span><span class="va">before_1960</span> <span class="op">&amp;</span> <span class="va">heavier_than_70_kg</span>, <span class="op">]</span><span class="op">$</span><span class="va">record_id</span></span>
<span></span>
<span><span class="va">desired_records_v3</span> <span class="co">#Peek at IDs of the identified records</span></span></code></pre></div>
<pre><code>[1] 3 5</code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">######</span></span>
<span><span class="co">## Step 3: second call to REDCap</span></span>
<span><span class="co">#Return only records that met the age &amp; weight criteria.</span></span>
<span><span class="va">ds_some_rows_v3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redcap_read.html">redcap_read</a></span><span class="op">(</span></span>
<span>  redcap_uri <span class="op">=</span> <span class="va">uri</span>,</span>
<span>  token      <span class="op">=</span> <span class="va">token</span>,</span>
<span>  records    <span class="op">=</span> <span class="va">desired_records_v3</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></code></pre></div>
<pre><code>The data dictionary describing 17 fields was read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>2 records and 1 columns were read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>Starting to read 2 records  at 2022-08-14 21:12:22.</code></pre>
<pre><code>Reading batch 1 of 1, with subjects 3 through 5 (ie, 2 unique subject records).</code></pre>
<pre><code>2 records and 25 columns were read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>
 [36m── [39m  [1mColumn specification [22m  [36m──────────────────────────────────────────────────────── [39m
cols(
  .default = col_double(),
  name_first =  [31mcol_character() [39m,
  name_last =  [31mcol_character() [39m,
  address =  [31mcol_character() [39m,
  telephone =  [31mcol_character() [39m,
  email =  [31mcol_character() [39m,
  dob =  [34mcol_date(format = "") [39m,
  comments =  [31mcol_character() [39m,
  mugshot =  [31mcol_character() [39m
)
 [36mℹ [39m Use `spec()` for the full column specifications.</code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_some_rows_v3</span> <span class="co">#Examine the results.</span></span></code></pre></div>
<pre><code>  record_id name_first name_last                            address
1         3     Marcus      Wood     243 Hill St.\nGuthrie OK 73402
2         5   John Lee    Walker Hotel Suite\nNew Orleans LA, 70115
       telephone              email        dob age sex demographics_complete
1 (405) 321-3333       mw@mwood.net 1934-04-09  80   1                     2
2 (405) 321-5555 left@hippocket.com 1955-04-15  59   1                     2
  height weight  bmi
1 180.00     80 24.7
2 193.04    104 27.9
                                                                                     comments
1                                                                          completely made up
2 Had a hand for trouble and a eye for cash\n\nHe had a gold watch chain and a black mustache
        mugshot health_complete race___1 race___2 race___3 race___4 race___5
1 mugshot-3.jpg               2        0        0        0        1        1
2 mugshot-5.jpg               0        1        0        0        0        0
  race___6 ethnicity interpreter_needed race_and_ethnicity_complete
1        0         0                  1                           2
2        1         2                  0                           2</code></pre>
</div>
<div class="section level3">
<h3 id="additional-returned-information">Additional Returned Information<a class="anchor" aria-label="anchor" href="#additional-returned-information"></a>
</h3>
<p>The examples above have shown only the resulting <code>data.frame</code>, by specifying <code>$data</code> at the end of the call. However, more is available to those wanting additional information, such as:</p>
<ol style="list-style-type: decimal">
<li>The <code>data</code> object has the <code>data.frame</code>, as in the previous examples.</li>
<li>The <code>success</code> boolean value indicates if <code>redcap_read_oneshot</code> believes the operation completed as intended.</li>
<li>The <code>status_codes</code> is a collection of <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes" class="external-link">http status codes</a>, separated by semicolons. There is one code for each batch attempted.</li>
<li>The <code>outcome_messages</code>: A collection of human readable strings indicating the operations’ semicolons. There is one code for each batch attempted. In an unsuccessful operation, it should contain diagnostic information.</li>
<li>The <code>records_collapsed</code> field passed to the API. This shows which record subsets, if any, were requested.</li>
<li>The <code>fields_collapsed</code> fields passed to the API. This shows which field subsets, if any, were requested.</li>
<li>The <code>elapsed_seconds</code> measures the duration of the call.</li>
</ol>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Return only the fields record_id, name_first, and age</span></span>
<span><span class="va">all_information</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redcap_read.html">redcap_read</a></span><span class="op">(</span></span>
<span>  redcap_uri <span class="op">=</span> <span class="va">uri</span>,</span>
<span>  token      <span class="op">=</span> <span class="va">token</span>,</span>
<span>  fields     <span class="op">=</span> <span class="va">desired_fields_v1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code>The data dictionary describing 17 fields was read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>5 records and 1 columns were read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>Starting to read 5 records  at 2022-08-14 21:12:23.</code></pre>
<pre><code>Reading batch 1 of 1, with subjects 1 through 5 (ie, 5 unique subject records).</code></pre>
<pre><code>5 records and 3 columns were read from REDCap in 0.2 seconds.  The http status code was 200.</code></pre>
<pre><code>
 [36m── [39m  [1mColumn specification [22m  [36m──────────────────────────────────────────────────────── [39m
cols(
  record_id =  [32mcol_double() [39m,
  name_first =  [31mcol_character() [39m,
  age =  [32mcol_double() [39m
)</code></pre>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_information</span> <span class="co">#Inspect the additional information</span></span></code></pre></div>
<pre><code>$data
  record_id name_first age
1         1     Nutmeg  11
2         2     Tumtum  11
3         3     Marcus  80
4         4      Trudy  61
5         5   John Lee  59

$success
[1] TRUE

$status_codes
[1] "200"

$outcome_messages
[1] "5 records and 3 columns were read from REDCap in 0.2 seconds.  The http status code was 200."

$records_collapsed
[1] ""

$fields_collapsed
[1] "record_id,name_first,age"

$forms_collapsed
[1] ""

$events_collapsed
[1] ""

$filter_logic
[1] ""

$datetime_range_begin
[1] NA

$datetime_range_end
[1] NA

$elapsed_seconds
[1] 1.074687</code></pre>
</div>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<p>For the sake of documentation and reproducibility, the current report was rendered in the following environment. Click the line below to expand.</p>
<details><p><summary>Environment <span class="glyphicon glyphicon-plus-sign"></span></summary></p>
<pre><code> [1m [36m─ Session info ─────────────────────────────────────────────────────────────── [39m [22m
  [3m [90msetting  [39m [23m  [3m [90mvalue [39m [23m
 version  R version 4.2.1 (2022-06-23)
 os       macOS Big Sur ... 10.16
 system   x86_64, darwin17.0
 ui       X11
 language en
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       UTC
 date     2022-08-14
 pandoc   2.7.3 @ /usr/local/bin/ (via rmarkdown)

 [1m [36m─ Packages ─────────────────────────────────────────────────────────────────── [39m [22m
  [3m [90mpackage     [39m [23m  [3m [90m* [39m [23m  [3m [90mversion  [39m [23m  [3m [90mdate (UTC) [39m [23m  [3m [90mlib [39m [23m  [3m [90msource [39m [23m
 backports     1.4.1     [90m2021-12-13 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 bit           4.0.4     [90m2020-08-04 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 bit64         4.0.5     [90m2020-08-30 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 bslib         0.4.0     [90m2022-07-16 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 cachem        1.0.6     [90m2021-08-19 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 checkmate     2.1.0     [90m2022-04-21 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 cli           3.3.0     [90m2022-04-25 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 colorspace    2.0-3     [90m2022-02-21 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 crayon        1.5.1     [90m2022-03-26 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 curl          4.3.2     [90m2021-06-23 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 desc          1.4.1     [90m2022-03-06 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 digest        0.6.29    [90m2021-12-01 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 dplyr         1.0.9     [90m2022-04-28 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 ellipsis      0.3.2     [90m2021-04-29 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 evaluate      0.16      [90m2022-08-09 [39m  [90m[1] [39m  [90mCRAN (R 4.2.1) [39m
 fansi         1.0.3     [90m2022-03-24 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 fastmap       1.1.0     [90m2021-01-25 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 fs            1.5.2     [90m2021-12-08 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 generics      0.1.3     [90m2022-07-05 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 glue          1.6.2     [90m2022-02-24 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 hms           1.1.1     [90m2021-09-26 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 htmltools     0.5.3     [90m2022-07-18 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 httr          1.4.3     [90m2022-05-04 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 jquerylib     0.1.4     [90m2021-04-26 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 jsonlite      1.8.0     [90m2022-02-22 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 kableExtra    1.3.4     [90m2021-02-20 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 knitr       * 1.39      [90m2022-04-26 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 lifecycle     1.0.1     [90m2021-09-24 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 magrittr    * 2.0.3     [90m2022-03-30 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 memoise       2.0.1     [90m2021-11-26 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 munsell       0.5.0     [90m2018-06-12 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 pillar        1.8.0     [90m2022-07-18 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 pkgconfig     2.0.3     [90m2019-09-22 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 pkgdown       2.0.6     [90m2022-07-16 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 purrr         0.3.4     [90m2020-04-17 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 R6            2.5.1     [90m2021-08-19 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 ragg          1.2.2     [90m2022-02-21 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 readr         2.1.2     [90m2022-01-30 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 REDCapR     *  [1m [35m1.1.9001 [39m [22m  [90m2022-08-14 [39m  [90m[1] [39m  [1m [35mlocal [39m [22m
 rlang         1.0.4     [90m2022-07-12 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 rmarkdown     2.14      [90m2022-04-25 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 rprojroot     2.0.3     [90m2022-04-02 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 rstudioapi    0.13      [90m2020-11-12 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 rvest         1.0.2     [90m2021-10-16 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 sass          0.4.2     [90m2022-07-16 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 scales        1.2.0     [90m2022-04-13 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 sessioninfo   1.2.2     [90m2021-12-06 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 stringi       1.7.8     [90m2022-07-11 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 stringr       1.4.0     [90m2019-02-10 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 svglite       2.1.0     [90m2022-02-03 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 systemfonts   1.0.4     [90m2022-02-11 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 textshaping   0.3.6     [90m2021-10-13 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 tibble        3.1.8     [90m2022-07-22 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 tidyselect    1.1.2     [90m2022-02-21 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 tzdb          0.3.0     [90m2022-03-28 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 utf8          1.2.2     [90m2021-07-24 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 vctrs         0.4.1     [90m2022-04-13 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 viridisLite   0.4.0     [90m2021-04-13 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 vroom         1.5.7     [90m2021-11-30 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 webshot       0.5.3     [90m2022-04-14 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 withr         2.5.0     [90m2022-03-03 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 xfun          0.32      [90m2022-08-10 [39m  [90m[1] [39m  [90mCRAN (R 4.2.1) [39m
 xml2          1.3.3     [90m2021-11-30 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m
 yaml          2.3.5     [90m2022-02-21 [39m  [90m[1] [39m  [90mCRAN (R 4.2.0) [39m

 [90m [1] /Users/runner/work/_temp/Library [39m
 [90m [2] /Library/Frameworks/R.framework/Versions/4.2/Resources/library [39m

 [1m [36m────────────────────────────────────────────────────────────────────────────── [39m [22m</code></pre>
</details><p>Report rendered by runner at 2022-08-14, 21:12 +0000 in 12 seconds.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Will Beasley.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'd672935e2d904316d6ee40239317764e',
    indexName: 'redcapr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
