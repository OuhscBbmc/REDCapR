<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Read a token and other credentials from a (non-REDCap) database or file — retrieve_credential • REDCapR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Read a token and other credentials from a (non-REDCap) database or file — retrieve_credential"><meta name="description" content="These functions are not essential to calling the REDCap API,
but instead are functions that help manage tokens securely."><meta property="og:description" content="These functions are not essential to calling the REDCap API,
but instead are functions that help manage tokens securely."><meta property="og:image" content="https://ouhscbbmc.github.io/REDCapR/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">REDCapR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/OuhscBbmc/REDCapR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Read a token and other credentials from a (non-REDCap) database or file</h1>
      <small class="dont-index">Source: <a href="https://github.com/OuhscBbmc/REDCapR/blob/main/R/retrieve-credential.R" class="external-link"><code>R/retrieve-credential.R</code></a></small>
      <div class="d-none name"><code>retrieve_credential.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions are not essential to calling the REDCap API,
but instead are functions that help manage tokens securely.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">retrieve_credential_local</span><span class="op">(</span></span>
<span>  <span class="va">path_credential</span>,</span>
<span>  <span class="va">project_id</span>,</span>
<span>  check_url            <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  check_username       <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  check_token_pattern  <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  username             <span class="op">=</span> <span class="cn">NA_character_</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">retrieve_credential_mssql</span><span class="op">(</span></span>
<span>  <span class="va">project_id</span>,</span>
<span>  <span class="va">instance</span>,</span>
<span>  <span class="va">dsn</span>,</span>
<span>  channel    <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">create_credential_local</span><span class="op">(</span></span>
<span>  <span class="va">path_credential</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-path-credential">path_credential<a class="anchor" aria-label="anchor" href="#arg-path-credential"></a></dt>
<dd><p>The file path to the CSV containing the credentials.
Required.</p></dd>


<dt id="arg-project-id">project_id<a class="anchor" aria-label="anchor" href="#arg-project-id"></a></dt>
<dd><p>The ID assigned to the project withing REDCap.  This
allows the user to store tokens to multiple REDCap projects in one file.
Required</p></dd>


<dt id="arg-check-url">check_url<a class="anchor" aria-label="anchor" href="#arg-check-url"></a></dt>
<dd><p>A <code>logical</code> value indicates if the url in the credential
file should be checked to have approximately the correct form.  Defaults
to TRUE.
<code>retrieve_credential_local()</code>.</p></dd>


<dt id="arg-check-username">check_username<a class="anchor" aria-label="anchor" href="#arg-check-username"></a></dt>
<dd><p>A <code>logical</code> value indicates if the username in the
credential file should be checked against the username returned by R.
Defaults to FALSE.</p></dd>


<dt id="arg-check-token-pattern">check_token_pattern<a class="anchor" aria-label="anchor" href="#arg-check-token-pattern"></a></dt>
<dd><p>A <code>logical</code> value indicates if the token in the
credential file is a 32-character hexadecimal string.  Defaults to FALSE.</p></dd>


<dt id="arg-username">username<a class="anchor" aria-label="anchor" href="#arg-username"></a></dt>
<dd><p>A character value used to retrieve a credential.
See the Notes below. Optional.</p></dd>


<dt id="arg-instance">instance<a class="anchor" aria-label="anchor" href="#arg-instance"></a></dt>
<dd><p>The casual name associated with the REDCap instance on
campus.  This allows one credential system to accommodate multiple
instances on campus.  Required</p></dd>


<dt id="arg-dsn">dsn<a class="anchor" aria-label="anchor" href="#arg-dsn"></a></dt>
<dd><p>A <a href="https://en.wikipedia.org/wiki/Data_source_name" class="external-link">DSN</a> on the
local machine that points to the desired MSSQL database. Required.</p></dd>


<dt id="arg-channel">channel<a class="anchor" aria-label="anchor" href="#arg-channel"></a></dt>
<dd><p>An <em>optional</em> connection handle as returned by
<code><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">DBI::dbConnect()</a></code>.  See Details below. Optional.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of the following elements are returned from
<code>retrieve_credential_local()</code> and <code>retrieve_credential_mssql()</code>:</p><ul><li><p><code>redcap_uri</code>: The URI of the REDCap Server.</p></li>
<li><p><code>username</code>: Username.</p></li>
<li><p><code>project_id</code>: The ID assigned to the project within REDCap.</p></li>
<li><p><code>token</code>: The token to pass to the REDCap server</p></li>
<li><p><code>comment</code>: An optional string that is ignored by REDCapR
but can be helpful for humans.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If the database elements are created with the script provided in package's
'Security Database' vignette, the default values will work.</p>
<p>The <code>create_credential_local()</code> function copies a
<a href="https://github.com/OuhscBbmc/REDCapR/blob/master/inst/misc/skeleton.credentials" class="external-link">static file</a>
to the location specified in the <code>path_credential</code> argument.
Each record represents one accessible project per user.
Follow these steps to adapt to your desired REDCap project(s):</p><ol><li><p>Modify the credential file for the REDCap API with a text editor
like <a href="https://notepad-plus-plus.org/" class="external-link">Notepad++</a>,
Visual Studio Code, or
<a href="https://www.nano-editor.org/" class="external-link">nano</a>.
Replace existing records with the information from your projects.
Delete the remaining example records.</p></li>
<li><p>Make sure that the file (with the sensitive password-like) tokens
is stored securely!</p></li>
<li><p>Contact your REDCap admin to request the URI &amp; token and
discuss institutional policies.</p></li>
<li><p>Ask your institution's IT security team for their recommendation</p></li>
<li><p>For more info, see https://ouhscbbmc.github.io/REDCapR/articles/workflow-read.html
and https://ouhscbbmc.github.io/REDCapR/reference/retrieve_credential.html</p></li>
<li><p>Double-check the file is secured and not accessible by other users.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p><em>Storing credentials on a server is preferred</em></p>
<p>Although we strongly encourage storing all the tokens on a central server
(<em>e.g.</em>, see the <code>retrieve_credential_mssql()</code> function and the
"SecurityDatabase" vignette), there are times when this approach is not
feasible and the token must be stored locally.  Please contact us
if your institution is using something other than SQL Server, and
would like help adapting this approach to your infrastructure.</p>
<p><em>Storing credentials locally</em></p>
<p>When storing credentials locally, typically the credential file
should be dedicated to just one user. Occasionally it makes sense to store
tokens for multiple users –usually it's for the purpose of testing.</p>
<p>The <code>username</code> field is connected only in the local credential file.
It does not need to be the same as the official username in REDCap.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Will Beasley</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># ---- Local File Example ----------------------------</span></span></span>
<span class="r-in"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"misc/dev-2.credentials"</span>, package <span class="op">=</span> <span class="st">"REDCapR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">p1</span>  <span class="op">&lt;-</span> <span class="fu">REDCapR</span><span class="fu">::</span><span class="fu">retrieve_credential_local</span><span class="op">(</span><span class="va">path</span>, <span class="fl">33L</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $redcap_uri</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "https://redcap-dev-2.ouhsc.edu/redcap/api/"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $username</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "myusername"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $project_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $token</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "9A068C425B1341D69E83064A2D273A70"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $comment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "simple"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="op">(</span><span class="va">p2</span>  <span class="op">&lt;-</span> <span class="fu">REDCapR</span><span class="fu">::</span><span class="fu">retrieve_credential_local</span><span class="op">(</span><span class="va">path</span>, <span class="fl">34L</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $redcap_uri</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "https://redcap-dev-2.ouhsc.edu/redcap/api/"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $username</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "myusername"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $project_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $token</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "DA6F2BB23146BD5A7EA3408C1A44A556"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $comment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "longitudinal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Create a skeleton of the local credential file to modify</span></span></span>
<span class="r-in"><span><span class="va">path_demo</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"temp"</span>, fileext <span class="op">=</span> <span class="st">".credentials"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create_credential_local</span><span class="op">(</span><span class="va">path_demo</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">path_demo</span><span class="op">)</span> <span class="co"># This is just a demo; don't delete the real file!</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Will Beasley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

